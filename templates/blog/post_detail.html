{% extends "base.html" %}

{% block title %}{{ post.title }} ‚Äì BakeUp{% endblock %}

{% block extra_head %}
<style>
  .bk-comments-section{
    max-width: 980px;
    margin: 24px auto 40px;
    padding: 0 18px 8px;
  }

  .bk-comments-title{
    font-family: "Boorsok","Baloo 2",cursive;
    font-size: 24px;
    color: #e93a4a;
    margin: 0 0 12px;
    font-weight:200;
  }

  .bk-comments-list{
    list-style: none;
    padding: 0;
    margin: 0 0 12px;
    display: flex;
    flex-direction: column;
    gap: 10px;
  }

  .bk-comment-item{
    background:#fff;
    border-radius:16px;
    padding:10px 12px;
    box-shadow:0 6px 18px rgba(0,0,0,.04);
  }

  .bk-comment-meta{
    font-size:12px;
    color:#a5737b;
    margin-bottom:4px;
  }

  .bk-comment-meta strong{
    color:#7b5a43;
  }

  .bk-comment-text{
    margin:0;
    font-size:14px;
    color:#5a4b44;
  }

  .bk-no-comments{
    font-size:14px;
    color:#7b6a62;
    margin-bottom:8px;
  }

  .bk-comments-actions{
    margin-top:4px;
  }

  .bk-comments-btn{
    display:inline-flex;
    align-items:center;
    gap:6px;
    background:#ffe5ee;
    color:#e93a4a;
    border-radius:999px;
    padding:6px 14px;
    font-size:13px;
    font-weight:700;
    text-decoration:none;
  }

  .bk-comments-btn:hover{
    filter:brightness(1.03);
  }

  .bk-comments-icon{
    width:18px;
    height:18px;
    display:block;
  }

  .bk-no-login{
    font-size:14px;
    color:#7b6a62;
  }

  .bk-no-login a{
    color:#e93a4a;
    font-weight:600;
    text-decoration:none;
  }

  .bk-no-login a:hover{
    text-decoration:underline;
  }

  .bk-post-detail{
    max-width: 900px;
    margin: 32px auto 50px;
    padding: 0 18px;
  }

  .bk-post-card{
    background:#ffffff;
    border-radius:26px;
    box-shadow:0 12px 30px rgba(0,0,0,.08);
    padding:22px 22px 24px;
  }

  .bk-post-main h1{
    margin:0 0 4px;
    color:#e93a4a;
    font-size:26px;
    font-family: "Boorsok","Baloo 2",cursive;
    font-weight:300;
    letter-spacing: 1px;
  }

  .bk-post-date{
    margin:0 0 6px;
    font-size:13px;
    color:#b27a84;
  }

  /* linha das categorias logo abaixo da data */
  .bk-post-categories{
    margin:0 0 10px;
    font-size:13px;
    color:#7b6a62;
  }

  .bk-post-categories a{
    color:#e93a4a;
    font-weight:600;
    text-decoration:none;
  }

  .bk-post-categories a:hover{
    text-decoration:underline;
  }

  .bk-post-description{
    margin:0 0 14px;
    font-size:14px;
    color:#5a4b44;
  }

  /* IMAGEM LOGO ABAIXO DA DESCRI√á√ÉO, MENORZINHA */
  .bk-post-thumb{
    max-width: 360px;
    margin: 0 auto 16px;
    border-radius:18px;
    overflow:hidden;
    background:#ffe5ee;
  }

  .bk-post-thumb img{
    width:100%;
    height:auto;
    display:block;
  }

  .bk-section-title{
    margin:14px 0 4px;
    font-size:16px;
    color:#e93a4a;
    font-weight:700;
  }

  .bk-text-block{
    font-size:14px;
    color:#5a4b44;
    line-height:1.6;
    background:#fff7f0;
    border-radius:16px;
    padding:10px 12px;
  }

  .bk-text-block p{ margin:0 0 .4rem; }

  .bk-post-actions{
    margin-top:16px;
    font-size:13px;
  }

  .bk-link{
    color:#e93a4a;
    font-weight:600;
    text-decoration:none;
    margin-right:10px;
  }

  .bk-link:hover{ text-decoration:underline; }

  .bk-link-danger{ color:#b0203b; }
</style>
{% endblock %}

{% block content %}
{% load static %}

<section class="bk-post-detail">
  <article class="bk-post-card">
    <div class="bk-post-main">
      <h1>{{ post.title }}</h1>

      <p class="bk-post-date">
        Publicado em {{ post.created_at|date:"d/m/Y H:i" }}
      </p>

      {# CATEGORIAS DO POST #}
      {% if post.categories.all %}
        <p class="bk-post-categories">
          Categorias:
          {% for category in post.categories.all %}
            <a href="{% url 'blog:category_detail' category.pk %}">
              {{ category.name }}
            </a>{% if not forloop.last %}, {% endif %}
          {% endfor %}
        </p>
      {% endif %}

      {% if post.description %}
        <p class="bk-post-description">{{ post.description }}</p>
      {% endif %}

      {% if post.image %}
        <div class="bk-post-thumb">
          <img src="{{ post.image.url }}" alt="Imagem de {{ post.title }}">
        </div>
      {% endif %}

      {% if post.ingredients %}
        <h2 class="bk-section-title">Ingredientes</h2>
        <div class="bk-text-block">
          {{ post.ingredients|linebreaksbr }}
        </div>
      {% endif %}

      {% if post.preparation %}
        <h2 class="bk-section-title">Modo de preparo</h2>
        <div class="bk-text-block">
          {{ post.preparation|linebreaksbr }}
        </div>
      {% endif %}

      <section id="comentarios" class="bk-comments-section">
        <h2 class="bk-comments-title">
          Coment√°rios ({{ comments|length }})
        </h2>

        {% if comments %}
          <ul class="bk-comments-list">
            {% for comment in comments %}
              <li class="bk-comment-item">
                <div class="bk-comment-meta">
                  <strong>{{ comment.author.username }}</strong>
                  <span>¬∑ {{ comment.created_at|date:"d/m/Y H:i" }}</span>
                </div>
                <p class="bk-comment-text">
                  {{ comment.text|linebreaksbr }}
                </p>
              </li>
            {% endfor %}
          </ul>
        {% else %}
          <p class="bk-no-comments">
            Ainda n√£o h√° coment√°rios nesta receita. Seja o primeiro a comentar! 
          </p>
        {% endif %}

        {% if user.is_authenticated %}
          <div class="bk-comments-actions">
            <a href="{% url 'blog:comment_create' post.pk %}" class="bk-comments-btn">
              <img src="{% static 'img/comment.png' %}" alt="" class="bk-comments-icon">
              Escrever coment√°rio
            </a>
          </div>
        {% else %}
          <p class="bk-no-login">
            <a href="{% url 'login' %}">Fa√ßa login</a> para deixar um coment√°rio. üíå
          </p>
        {% endif %}
      </section>

      <div class="bk-post-actions" style="margin-top: 1rem;">
        {% if user.is_authenticated %}
          <a href="{% url 'blog:post_update' post.pk %}" class="bk-link">Editar receita</a>
          <a href="{% url 'blog:post_delete' post.pk %}" class="bk-link bk-link-danger">Remover receita</a>
        {% endif %}
        <a href="{% url 'blog:post_list' %}" class="bk-link">Voltar para lista</a>
      </div>

    </div>
  </article>
</section>
{% endblock %}
